<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    *{
        margin: 0;
        padding:0;
    }
    ul{
        list-style: none;
    }
    .magicBox{
        width: 300px;
        height: 300px;
        margin: 150px auto;
        position: relative;
    }
    .magicBox.box {
        display: none;
    }
    .magicBox>div{
        width: 100%;
        height: 100%;
        opacity: 0.5;
        position: absolute;
        /* background-color:pink; */
    }
    .magicBox .top{
        /* background-color: hotpink; */
        transform: translateY(-150px) rotateX(-90deg);
    }
    .magicBox .down{
        /* background-color: yellow; */
        transform: translateY(150px) rotateX(90deg);
    }
    .magicBox .left{
        /* background-color: green; */
        transform: translateX(-150px) rotateY(-90deg);
    }
    .magicBox .right{
        /* background-color:blue; */
        transform: translateX(150px) rotateY(90deg);
    }
    .magicBox .front{
        /* background-color: red; */
        transform: translateZ(150px);
    }
    .magicBox .behind{
        /* background-color: skyblue; */
        transform: translateZ(-150px);
    }
    .magicBox ul li{
        float: left;
        width: 100px;
        height: 100px;
        position: relative;
        box-sizing: border-box;
        border: 1px solid #fff;
    }
    .animationMagic.box {
        display: block;
        transform-style: preserve-3d;
        transform: rotateX(-10deg) rotateY(-20deg);
        animation: updown 2s linear 2s infinite alternate;
    }
    @keyframes updown{
        0%{
            transform: rotateX(-10deg) rotateY(-20deg)
        }
        100%{
            transform: rotateX(360deg) rotateY(360deg);
        }
    }
    
    
    </style>
</head>
<body>
    <div class="box magicBox">
        <div class="top"></div>
        <div class="down"></div>
        <div class="left"></div>
        <div class="right"></div>
        <div class="front"></div>
        <div class="behind"></div>
    </div>
    
    <video id="video"></video>
</body>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://whois.pconline.com.cn/ipJson.jsp?callback=IPCallBack"></script>
<script>
$(function() {
    // 魔方
    // magic();
    $.ajax({
        type:"get",
        url: 'https://whois.pconline.com.cn/ipJson.jsp',
        /*使用jsonp解决跨域请求*/
        dataType: "jsonp",
        jsonp: "callback",
        jsonpCallback:"IPCallBack",
        // jsonpCallback:"?",
        success:(data)=>{
            console.log('getIP-success: ', data)
        },
        error: (err) => {
            console.log('getIP-error: ', err)
        }
    });



})

function magic() {
    var box=$(".box");
    box.addClass('animationMagic');
    var divs = box.children();
    var arrColor=["pink","yellow","red","green","skyblue","hotpink"];
    divs.each(function(index,el){
        var ul = $("<ul></ul>");
        for(var i =0;i<9;i++){
            var li = $("<li></li>");
            li.css("backgroundColor",arrColor[index]);
            ul.append(li);
        }
        $(el).append(ul);
    });
    // 先定义一个空的数组,加入随机数字
    var arrPostion=[];
    for(var i =0;i<54;i++){
        arrPostion.push(parseInt(Math.random()*324));
    }
    // console.log(arrPostion);
    // 根据定位的位置,实现归位效果!
    $("li").each(function(index,el){
        $(el).css({"left":arrPostion[index],"top":arrPostion[index]});
    });
    $("li").each(function(index,el){
        $(el).animate({"left":0,"top":0},2000);
    });
}

function IPCallBack(data) {
    console.log(data)
}

</script>

<script>
    const width = 480;
    const height = 320;
    const video = document.getElementById('video');

    //访问摄像头
    if (navigator.mediaDevices.getUserMedia || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia) {
        //调用用户媒体设备, 访问摄像头
        getUserMedia({video: {width: width, height: height}}, success, error);
    } else {
        alert('不支持访问用户媒体');
    }

    //访问用户媒体设备的兼容方法
    function getUserMedia(constraints, success, error) {
        if (navigator.mediaDevices.getUserMedia) {
            //最新的标准API
            navigator.mediaDevices.getUserMedia(constraints).then(success).catch(error);
        } else if (navigator.webkitGetUserMedia) {
            //webkit核心浏览器
            navigator.webkitGetUserMedia(constraints, success, error)
        } else if (navigator.mozGetUserMedia) {
            //firfox浏览器
            navigator.mozGetUserMedia(constraints, success, error);
        } else if (navigator.getUserMedia) {
            //旧版API
            navigator.getUserMedia(constraints, success, error);
        }
    }

    //成功回调
    function success(stream) {
        console.log('成功');
        //兼容webkit核心浏览器
        // const CompatibleURL = window.URL || window.webkitURL;
        //将视频流设置为video元素的源
        // video.src = CompatibleURL.createObjectURL(stream);
        video.srcObject = stream;
        video.play();
    }

    //失败回调
    function error(error) {
        console.log('失败');
        console.log("访问用户媒体设备失败", error);
    } 
 
 
</script>
</html>
